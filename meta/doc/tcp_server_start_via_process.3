.TH tcp_server_start_via_process 3
.SH NAME
.Nm tcp_server_start_via_process()
.Nd Let the process ADT start the tcp_server
.SH SYNOPSIS
.Fd #include <tcp_server.h>
.Fo "int tcp_server_start_via_process"
.Fa "process p"
.Fa "tcp_server s"
.Fc
.SH DESCRIPTION
Let the process ADT start the tcp server instead of starting it
ourselves. The process ADT handles proper startup and shutdown
and 
.Nm
is a utility function to register a tcp_server object 
with a process object.
.SH SEE ALSO
.Xr meta_process 7 ,
.Xr process_start 3 ,
.Xr process_add_object_to_start 3 
.SH EXAMPLE
.Bd -literal
#include <meta_process.h>
#include <tcp_server.h>
#include <connection.h>
void* echoserverfn(void* arg)
{
	int c;
	connection conn = arg;
	tcp_server s = connection_arg2(conn);
	while(!tcp_server_shutting_down(s) 
	&& connection_getc(conn, &c)) {
		connection_putc(conn, c);
		connection_flush(conn);
	}
	return NULL;
}
int main(void)
{
	process p = process_new("echoserver");
	tcp_server s = tcp_server_new();
	tcp_server_set_service_function(
		s, 
		echoserverfn,
		s);
	tcp_server_init(s);
	tcp_server_start_via_process(p, s);
	process_start(p, 0);
	process_wait_for_shutdown(p);
	
	tcp_server_free(s);
	process_free(p);
	return 0;
}
.Ed
.SH AUTHOR
.An B. Augestad, bjorn.augestad@gmail.com
